## Sequential-konwledge-aware Next POI recommendation: A Meta-learning Approach

The paper proposes a meta-learned sequential-knowledge-aware recommender (**Meta-SKR**), which utilizes **sequential, spatial, temporal, and social knowledge** to recommend the next POI. This framework mainly includes four modules. First, in a **graph construction module**, a novel type of knowledge graph, **sequential-knowledge-graph (SKG)** is built to model users' check-in patterns. Then, a **meta-learning module** based on **latent embedding optimization** is introduced to generate **user-specific** parameters, which are used as weights of subsequent **sequential-konwledge-aware embedding module** that learns the representation vectors of nodes and edges in **SKG**.
Finally, the **prediction module** aims to recommend POI by inferring **potential links** of knowledge graphs.

Given a user, we could collect his overall check-in records in **chronological** order, and then generate a set of subsequences by **continuously** sampling subsequence with **same length** from **history check-in records** with fixed **stride**. In this way, each user will have his own subsequence set, then we select several **successive check-in subsequences** as **training set** of meta-learning task and randomly choose subsequences that have no intersection with training set as the test set. Note that **each subsequence** corresponding to a **SKG**.

The **graph construction module** is responsible for generating **triples** that describe relations between two nodes by **traversing subsequence sequentially**.
In other words, **sequential-knowledge-graph (SKG)** is a set of triples. There are **three types** of nodes and **five types** of relation(edge) in **SKG**, which contains sequential, spatial, temporal, and social context information.

In **meta-learning module**, the **SKGs** in training set are fed into **encoder and relation network** to get **user-specific** latent vector, which then are used to generate **user-specific** parameters by a **decoder**. The **parameters** are used to initialize the **weights** of subsequent **embedding network** in **sequential-knowledge-aware embedding module** and will be updated based on the returned loss after training data passing through **the initialized embedding network**. And then **test data** will be used to evaluate the **embedding network** and make predictions, and the returned loss will be utilized to update **parameters** of the meta-learner itself. 

In **sequential-knowledge-aware embedding module**, the node and edge representation vector will be learned. Specifically, the **SKGs (a series of triples)** are inputs of **embedding network**. Each **triple** representation could be calculated as **linear transformation** of the **concatentation** of its components' representation vectors, which are **pre-trained**. The author models the **intra-SKG and inter-SKG** memories with **gated recurrent units (GRUs)** to get the **updated triple embeddings**. Then, an **attention-based** approach with **GNNs** is used to propogate information **from triples to nodes**, considering the **role (head/tail)** the node playing in triples. Therefore, node representation vectors will be learned. And a linear transformation is performed on **relation embedding matrix** to get further representation of relations(edges).

In **prediction module**, given a **potential triple**, we predict the probability a user would take a specific POI**(tail node)** as his next destination using **ConvE** method.